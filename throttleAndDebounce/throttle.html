<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>节流</title>
    <style>
      .container {
        width: 100px;
        height: 100px;
        background-color: #f00;
      }
    </style>
  </head>
  <body>
    <div class="container"></div>
    <!-- 节流:一定时间内只执行一次 -->
    <!-- ；两种：1.时间戳  2.定时器  3.时间戳+定时器 -->
    <script>
      //   var count = 0;
      //   // 定时器
      //   var timer = null;
      //   document
      //     .querySelector(".container")
      //     .addEventListener("mousemove", (e) => {
      //       this.throttle(1000);
      //     });
      //   throttle = function (delay) {
      //     if (!timer) {
      //       timer = setTimeout(() => {
      //         count++;
      //         // console.log(`执行了${count}次`);
      //         timer = null;
      //       }, delay);
      //     }
      //   };
      //   时间戳
      //   var count2 = 0;
      //   var throttle = function (delay) {
      //     var prev = Date.now();
      //     // 上面程序编译执行的时候就会执行
      //     // 执行然后返回一个函数--作为事件的回调函数
      //     return function () {
      //       var now = Date.now();
      //       if (now - prev >= delay) {
      //         // func.apply(context, args);
      //         console.log("开始执行");
      //         prev = Date.now();
      //         // prev  now  造成一个时间差，模拟一个定时器
      //       }
      //     };
      //   };
      //   document
      //     .querySelector(".container")
      //     .addEventListener("mousemove", this.throttle(1000));

      // 程序编译-执行下来上面应该为
      /**
         *
         * prev="XXXX"
         * 
         * document.querySelector(".container").addEventListener("mousemove",  ()=> {
                var now = Date.now();
                if (now - prev >= delay) {
                    // func.apply(context, args);
                    console.log("开始执行");
                    prev = Date.now();
                    // prev  now  造成一个时间差，模拟一个定时器
                }
            });
        */
      var prev = Date.now();
      document.querySelector(".container").addEventListener("mousemove", () => {
        var now = Date.now();
        if (now - prev >= 1000) {
          // func.apply(context, args);
          console.log("开始执行");
          prev = Date.now();
          // prev  now  造成一个时间差，模拟一个定时器
        }
      });
    </script>
  </body>
</html>
